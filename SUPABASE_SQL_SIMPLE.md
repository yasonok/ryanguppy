# Supabase SQL - 簡化版

請在 Supabase SQL Editor 中**逐個執行**：

## Step 1: 建立 products 資料表
```sql
CREATE TABLE products (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name TEXT NOT NULL,
  type TEXT,
  gender TEXT,
  price INTEGER NOT NULL,
  stock INTEGER DEFAULT 0,
  image_url TEXT,
  status TEXT DEFAULT 'available',
  note TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

## Step 2: 建立 orders 資料表
```sql
CREATE TABLE orders (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  customer_name TEXT NOT NULL,
  customer_phone TEXT,
  customer_line_id TEXT,
  shipping_address TEXT,
  total_amount INTEGER NOT NULL,
  status TEXT DEFAULT 'pending',
  note TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

## Step 3: 建立 order_items 資料表
```sql
CREATE TABLE order_items (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  order_id BIGINT REFERENCES orders(id),
  product_name TEXT NOT NULL,
  price INTEGER NOT NULL,
  quantity INTEGER NOT NULL,
  subtotal INTEGER NOT NULL
);
```

## Step 4: 設定權限（新增 policies）

### Products 讀取權限
```sql
ALTER TABLE products ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Anyone can read products" ON products FOR SELECT USING (true);
```

### Orders 新增權限
```sql
ALTER TABLE orders ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Anyone can create orders" ON orders FOR INSERT WITH CHECK (true);
```

### Order items 新增權限
```sql
ALTER TABLE order_items ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Anyone can create order items" ON order_items FOR INSERT WITH CHECK (true);
```

---

## 常見錯誤解決

如果出現 "relation already exists" 錯誤：
- 表示資料表已存在，可以跳過
- 繼續執行下一步

如果出現權限錯誤：
- 檢查是否用正確的帳號登入
- 需要 owner 或 admin 權限
